# dHydra - 量化九头蛇

---
**详细文档可以参考看云：**
http://www.kancloud.cn/emptyset/dhydra/125528

> 
> dHydra旨在为国内股票市场的量化交易分析提供一套数据清洗/存储的解决方案。
> 内容包含但不限于：
> - 对TuShare接口提供的数据提供现成的存储（以及导出/导入）方案
> - 获取3秒/条实时获取数据并持久化存储（以及导出/导入）
> - 获取新浪Level-2数据（新浪普及版，10档盘口与逐笔数据）
> - 数据可视化(TODO)
> - 基于Level-2高频数据的回测系统(TODO)
> - ***IMPORTANT: 由于在获取Level2高频数据时采用了异步io(asyncio)与多线程(threading)，作者精力有限，难以维护代码使它继续兼容python2。因此以后dHydra将只支持python3.4+版本***

## 使用对象
- 正在学习使用python进行数据分析/数据挖掘的同学
- 对金融市场进行大数据分析的企业和个人
- 量化投资分析师（Quant）

## Prerequisites

 - python 3.4+ (开发环境Ubuntu 15.10, python 3.5)
 - mongodb 3.2

## 安装dHydra
在命令行中输入以下命令进行安装——
```
pip install dHydra
```
## 升级dHydra到最新版本
```
pip install dHydra --upgrade
```
## 调用dHydra
```python
import dHydra
stock = dHydra.Stock()  #实例化Stock类
sina = dHydra.SinaFinance()		#实例化SinaFinance类
```
## 演示
例如：调用Stock类的start_realtime()方法来实时下载数据到
```python
stock.start_realtime()  
#start_realtime()方法用于实时获取3秒/次的股票数据，计算出实时换手率后存入mongodb
```
或者：调用Stock类的fetch_realtime()方法来返回所有A股的实时数据（5档盘口）。
```python
stock.fetch_realtime()
```

```
>>> stock.fetch_realtime().head(10)		#只显示前10条
The basicInfo is outdated. Trying to update basicInfo...
Stock Basic Info last updated on:  2016-03-04 03:28:33.730000  NO NEED to update right now...
    open  pre_close  price   high    low     volume        amount  b1_v  \
0   0.00      15.59   0.00   0.00   0.00          0  0.000000e+00   NaN   
1  11.65      11.67  11.58  12.20  11.30   23743032  2.776920e+08   239   
2  18.80      18.83  18.88  18.90  18.58   16622623  3.115732e+08    29   
3  18.68      18.66  18.50  19.05  18.36    5235251  9.793853e+07    30   
4  26.55      26.34  26.88  27.87  26.34    5825682  1.577169e+08     3   
5   7.25       7.28   7.17   7.57   7.17   42793356  3.133067e+08  2757   
6  10.70      10.73  10.63  11.20  10.61   34686493  3.775260e+08   618   
7  13.89      14.08  14.12  14.65  13.86    2620218  3.739386e+07     3   
8  15.40      15.69  15.64  15.99  15.40   10713644  1.679434e+08   229   
9  15.90      16.12  15.92  16.10  15.68  251842034  3.996301e+09  2346   

    b1_p  b2_v       ...          a2_p  a3_v   a3_p  a4_v   a4_p  a5_v   a5_p  \
0   0.00   NaN       ...          0.00   NaN   0.00   NaN   0.00   NaN   0.00   
1  11.58  1120       ...         11.60    72  11.61   125  11.62   208  11.63   
2  18.88    88       ...         18.90    64  18.91   102  18.92    96  18.93   
3  18.44   110       ...         18.53    21  18.54    32  18.58     5  18.59   
4  26.88     4       ...         26.90    26  26.91    50  26.92     2  26.93   
5   7.17  1751       ...          7.19  2651   7.20  1372   7.21   578   7.22   
6  10.63   674       ...         10.65   247  10.66    89  10.67    49  10.68   
7  14.10   132       ...         14.12    38  14.13    32  14.15     7  14.18   
8  15.63   105       ...         15.65  1676  15.66     2  15.67   118  15.69   
9  15.90  7559       ...         15.92  1476  15.95  1486  15.96  1363  15.97   

                 time    code  turn_over_ratio  
0 2016-03-03 15:05:54  002606         0.000000  
1 2016-03-03 15:05:54  000975         2.311716  
2 2016-03-03 15:05:54  600196         0.871738  
3 2016-03-03 15:05:54  300183         2.061707  
4 2016-03-03 15:05:54  600685         1.328659  
5 2016-03-03 15:05:54  000518         4.156568  
6 2016-03-03 15:05:54  000012         2.662964  
7 2016-03-03 15:05:54  600167         1.241809  
8 2016-03-03 15:05:54  002529         5.356822  
9 2016-03-03 15:05:54  600030         2.565978
```
更多用法请参考API文档
http://www.kancloud.cn/emptyset/dhydra/125528

## Mongodb数据结构设计说明（TODO）

  [1]: https://github.com/Emptyset110/dHydra.git
